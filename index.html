<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <title>For Husbands Who Still Don't Get It</title> 
  <h2>Because "Sorry" Sounds Better with a Bow on It</h2> 
<script>
document.addEventListener('DOMContentLoaded', function() {
  document.getElementById('giftForm').addEventListener('submit', function(event) {
    event.preventDefault(); 

    const reasonForArgument = document.getElementById('reason').value;
    const ageCategory = document.getElementById('ageCategory').value;
    const budgetCategory = document.getElementById('budgetCategory').value;
    const fightSeverity = document.getElementById('fightSeverity').value;

    // Simple validation (can be improved as needed)
    if(reasonForArgument && ageCategory && budgetCategory && fightSeverity) {
      generateGiftIdeas(reasonForArgument, ageCategory, budgetCategory, fightSeverity);
    } else {
      alert('Please fill in all fields.');
    }
  });

  async function generateGiftIdeas(reasonForArgument, ageCategory, budgetCategory, fightSeverity) {
    try {
      const response = await fetch('https://api.openai.com/v1/chat/completions', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Authorization': 'Bearer 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' // Securely handled API key
        },
        body: JSON.stringify({
          model: "gpt-3.5-turbo",
          messages: [
            {
              "role": "system",
              "content": "Generate a thoughtful gift idea for a husband to give his wife as an apology after their argument, considering the following details provided by the husband: Argument reason - '${reasonForArgument}', Age category - '${ageCategory}', Budget for gift- '${budgetCategory}', Fight severity - '${fightSeverity}'. Give a concise yet insightful rationale for your gift suggestion. If the budget indicated is 'Economy', or 'Moderate', ensure to sternly remind the husband in your response that his wife's happiness should not be budget-limited. Keep your overall response succinct and direct, to fit within 50 tokens"
            },
            {
              "role": "user",
              "content": `We had a fight about ${reasonForArgument}. Age category: ${ageCategory}, Budget: ${budgetCategory}, Severity: ${fightSeverity}. What is a suitable gift idea for me to show her I'm sorry?`
            }
          ],
          max_tokens: 80
        })
      });

      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      const data = await response.json();
      displayGiftIdeas(data.choices[0].message.content);
    } catch (error) {
      console.error('Error retrieving the gift ideas:', error);
      displayGiftIdeas('Sorry, there was a problem retrieving the gift ideas.');
    }
  }

  function displayGiftIdeas(giftIdeas) {
    document.getElementById('giftIdeas').innerText = giftIdeas;
  }
});
</script>

</head>
<body>
    <h1>Gift Idea Generator for Apologies</h1>
    <form id="giftForm">
        <label for="reason">Reason for Argument:</label>
        <input type="text" id="reason" name="reason" required><br><br>

        <label for="ageCategory">Age Category:</label>
        <select id="ageCategory" name="ageCategory" required>
            <option value="Adults">Adults</option>
            <option value="Middle-Aged">Middle-Aged</option>
            <option value="Seniors">Seniors</option>
        </select><br><br>

        <label for="budgetCategory">Budget Category:</label>
        <select id="budgetCategory" name="budgetCategory" required>
            <option value="Economy">Economy</option>
            <option value="Moderate">Moderate</option>
            <option value="Premium">Premium</option>
            <option value="Luxury">Luxury</option>
        </select><br><br>

        <label for="fightSeverity">Severity of the Fight:</label>
        <select id="fightSeverity" name="fightSeverity" required>
            <option value="Mild">Mild</option>
            <option value="Serious">Serious</option>
            <option value="Grave">Grave</option>
        </select><br><br>

        <button type="submit">Generate Gift Ideas</button>
    </form>

    <div id="giftIdeas"></div>
</body>
</html>
